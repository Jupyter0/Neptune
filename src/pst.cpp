#include "pst.h"

constexpr int midgamePST[6][64] = {
    {
        //Pawns, Central pawns should be pushed. Flank pawns near the king need to stay back
        0,   0,   0,   0,   0,   0,   0,   0,

       50,  50,  50,  50,  50,  50,  50,  50,

       10,  10,  20,  30,  30,  20,  10,  10,

       10,  10,  10,  25,  25,  10,  10,  10,

      -50, -20,  20,  50,  50,  20, -20, -50,

       20,  10,  20,  20,  20,  20,  10,  20,

       50,  50,  20, -20, -20,  20,  50,  50,

        0,   0,   0,   0,   0,   0,   0,   0,
    },
    {
        //Knights, Knight on the rim is dim, they should also stay back to not get bullied by pawns
      -50, -50, -50, -50, -50, -50, -50, -50,

      -50, -20, -10, -20, -20, -10, -20, -50,

      -50,   0,   0,   0,   0,   0,   0, -50,

      -50,   0,  10,  10,  10,  10,   0, -50,

      -50,   0,  20,  10,  10,  20,   0, -50,

      -50,  10,  40,  20,  20,  40,  10, -50,

      -50, -20,  20,  20,  20,  20,  50, -50,

      -50,   0, -50, -50, -50, -50,   0, -50,
    },
    {
        //Bishops, they should either be supporting the middle, or on the long diagonal.
      -20, -10, -10, -10, -10, -10, -10, -20,
        
      -10,   0,   0,   0,   0,   0,   0, -10,

      -10,   0,   5,  10,  10,   5,   0, -10,

      -10,   5,   5,  10,  10,   5,   5, -10,

      -10,   0,  10,  10,  10,  10,   0, -10,

      -10,  10,  10,  10,  10,  10,  10, -10,
        
      -10,  10,   0,   0,   0,   0,  10, -10,

      -20, -10, -10, -10, -10, -10, -10, -20
    },
    {
        //Rooks, Rook on the seventh and to incentivize castling
        0,   0,   0,   5,   5,   0,   0,   0,

       -5,  15,  15,  15,  15,  15,  15,  -5,

       -5,   0,   0,   0,   0,   0,   0,  -5,

       -5,   0,   0,   0,   0,   0,   0,  -5,

       -5,   0,   0,   0,   0,   0,   0,  -5,

       -5,   0,   0,   0,   0,   0,   0,  -5,

        5,   0,   0,   0,   0,   0,   0,   5,

        0, -50,  -40,  50,  30,  50, -50,  0
    },
    {
        //Queens should stay back in the opening.
      -20, -10, -10,  -5,  -5, -10, -10, -20,

      -10,   0,   0,   0,   0,   0,   0, -10,

      -10,   0,   5,   5,   5,   5,   0, -10,

       -5,   0,   5,   5,   5,   5,   0,  -5,

        0,   0,   5,   5,   5,   5,   0,  -5,

      -10,   5,   5,   5,   5,   5,   0, -10,

      -10,  10,  10,  10,  10,  10,  10, -10,

      -20, -10, -10,  -5,  -5, -10, -10, -20
    },
    {
        //King, stay at home in the castle. 
      -30, -40, -40, -50, -50, -40, -40, -30,

      -30, -40, -40, -50, -50, -40, -40, -30,

      -30, -40, -40, -50, -50, -40, -40, -30,

      -30, -40, -40, -50, -50, -40, -40, -30,

      -20, -30, -30, -40, -40, -30, -30, -20,

      -10, -20, -20, -20, -20, -20, -20, -10,

       20,  20,   0,   0,   0,   0,  20,  20,

       20,  30,  20,   0,   0,  10,  30,  20
    }
};

constexpr int endgamePST[6][64] = {
    {
        //Pawns, passed pawns must be pushed!
        0,   0,   0,   0,   0,   0,   0,   0,

       50,  50,  50,  50,  50,  50,  50,  50,

       40,  40,  40,  40,  40,  40,  40,  40,

       30,  30,  30,  30,  30,  30,  30,  30,

       20,  20,  20,  20,  20,  20,  20,  20,

       10,  10,  10,  10,  10,  10,  10,  10,

        0,   0,   0,   0,   0,   0,   0,   0,

        0,   0,   0,   0,   0,   0,   0,   0,
    },
    {
        //Knights, Knight on the rim is still dim
      -50, -50, -50, -50, -50, -50, -50, -50,

      -50, -30, -30, -30, -30, -30, -30, -50,

      -50, -30,  20,  20,  20,  20, -30, -50,

      -50, -30,  20,  20,  20,  20, -30, -50,

      -50, -30,  20,  20,  20,  20, -30, -50,

      -50, -30,  20,  20,  20,  20, -30, -50,

      -50, -30, -30, -30, -30, -30, -30, -50,

      -50, -50, -50, -50, -50, -50, -50, -50,
    },
    {
        //Bishops, as long as they arent on the edge (this is actually the same table as the horse)
      -50, -50, -50, -50, -50, -50, -50, -50,

      -50, -30, -30, -30, -30, -30, -30, -50,

      -50, -30,  20,  20,  20,  20, -30, -50,

      -50, -30,  20,  20,  20,  20, -30, -50,

      -50, -30,  20,  20,  20,  20, -30, -50,

      -50, -30,  20,  20,  20,  20, -30, -50,

      -50, -30, -30, -30, -30, -30, -30, -50,

      -50, -50, -50, -50, -50, -50, -50, -50,
    },
    {
        //Rooks, They just go crazy in endgames, it doesent matter where they are tbh
       30,  30,  30,  30,  30,  30,  30,  30,

       30,  30,  30,  30,  30,  30,  30,  30,

       30,  30,  30,  30,  30,  30,  30,  30,

       30,  30,  30,  30,  30,  30,  30,  30,

       30,  30,  30,  30,  30,  30,  30,  30,

       30,  30,  30,  30,  30,  30,  30,  30,

       30,  30,  30,  30,  30,  30,  30,  30,

       30,  30,  30,  30,  30,  30,  30,  30
    },
    {
        //Queens, just go ham
      100, 100, 100, 100, 100, 100, 100, 100,

      100, 100, 100, 100, 100, 100, 100, 100,

      100, 100, 100, 100, 100, 100, 100, 100,

      100, 100, 100, 100, 100, 100, 100, 100,

      100, 100, 100, 100, 100, 100, 100, 100,

      100, 100, 100, 100, 100, 100, 100, 100,

      100, 100, 100, 100, 100, 100, 100, 100,

      100, 100, 100, 100, 100, 100, 100, 100
    },
    {
        //King, time to stretch the legs, again same table as the horse
      -50, -50, -50, -50, -50, -50, -50, -50,

      -50, -30, -30, -30, -30, -30, -30, -50,

      -50, -30,  20,  20,  20,  20, -30, -50,

      -50, -30,  20,  20,  20,  20, -30, -50,

      -50, -30,  20,  20,  20,  20, -30, -50,

      -50, -30,  20,  20,  20,  20, -30, -50,

      -50, -30, -30, -30, -30, -30, -30, -50,

      -50, -50, -50, -50, -50, -50, -50, -50,
    },
};

constexpr std::array<int, 7> staticValue = []() {
    std::array<int, 7> table {};
    table[PAWN] = 100;
    table[KNIGHT] = 300;
    table[BISHOP] = 300;
    table[ROOK] = 500;
    table[QUEEN] = 900;
    
    return table;
}();


int PieceValue(Piece piece, int square, int remainingPieces) {
    bool isEndgame = remainingPieces <= 10;
    auto& pst = isEndgame ? endgamePST : midgamePST;

    return pst[piece - 1][square] + staticValue[piece];
}